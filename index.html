<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renz Junkshop - Inventory & Sales System</title>
    
    <meta name="theme-color" content="#27ae60">
    <meta name="description" content="Renz Junkshop Inventory and Sales Management System">
    <link rel="manifest" href="manifest.json">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 50%, #58d68d 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }
        
        .header {
            background: linear-gradient(135deg, #1e8449, #27ae60, #2ecc71);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="20" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="30" cy="80" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="70" cy="90" r="2.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(100px); }
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .nav-tabs {
            background: #34495e;
            display: flex;
            justify-content: center;
            padding: 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab-button {
            background: transparent;
            color: white;
            border: none;
            padding: 20px 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            border-bottom-color: #f39c12;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .status-bar {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #27ae60;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            border-radius: 15px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        select, input, button, textarea {
            padding: 12px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: #27ae60;
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.3);
            transform: translateY(-2px);
        }
        
        button {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .btn-warning:hover {
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .btn-danger:hover {
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .btn-info:hover {
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
        }
        
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-left: 5px solid #27ae60;
            transition: all 0.3s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .summary-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .summary-card .number {
            font-size: 2.5em;
            font-weight: bold;
            color: #27ae60;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }
        
        .summary-card .subtitle {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .data-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
            transition: all 0.3s ease;
        }
        
        tr:hover {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-low {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .status-normal {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }
        
        .status-sold {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .action-btn {
            padding: 6px 12px;
            margin: 2px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            transform: scale(1.1);
        }
        
        .btn-sell {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-edit {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-delete {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #e74c3c;
            transform: scale(1.2);
        }
        
        .receipt {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            font-family: 'Courier New', monospace;
            max-width: 400px;
            margin: 20px auto;
        }
        
        .receipt-header {
            text-align: center;
            border-bottom: 2px dashed #27ae60;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .receipt-footer {
            text-align: center;
            border-top: 2px dashed #27ae60;
            padding-top: 15px;
            margin-top: 15px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }
        
        .empty-state h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
            color: #34495e;
        }
        
        .empty-state p {
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .file-input {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .tab-button {
                padding: 15px 20px;
                font-size: 14px;
            }
            
            .controls {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .summary {
                grid-template-columns: 1fr;
            }
            
            table, th, td {
                font-size: 14px;
            }
            
            th, td {
                padding: 10px 8px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>♻️ RENZ JUNKSHOP</h1>
            <p>Professional Inventory & Sales Management System</p>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <div class="status-indicator"></div>
                <span>System Online</span>
            </div>
            <div class="status-item">
                💾 Auto-Save: <strong>Enabled</strong>
            </div>
            <div class="status-item">
                📅 Last Updated: <span id="lastUpdated">Never</span>
            </div>
            <div class="status-item">
                💰 Today's Sales: <strong>₱<span id="todaySales">0.00</span></strong>
            </div>
        </div>
        
        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('inventory')">📦 Inventory</button>
            <button class="tab-button" onclick="showTab('sales')">💰 Sales</button>
            <button class="tab-button" onclick="showTab('reports')">📊 Reports</button>
            <button class="tab-button" onclick="showTab('settings')">⚙️ Settings</button>
        </div>
        
        <div id="inventory" class="tab-content active">
            <div class="summary">
                <div class="summary-card">
                    <h3>Total Items</h3>
                    <div class="number" id="totalItems">0</div>
                    <div class="subtitle">In Inventory</div>
                </div>
                <div class="summary-card">
                    <h3>Categories</h3>
                    <div class="number" id="totalCategories">0</div>
                    <div class="subtitle">Active Categories</div>
                </div>
                <div class="summary-card">
                    <h3>Low Stock</h3>
                    <div class="number" id="lowStockItems">0</div>
                    <div class="subtitle">Need Attention</div>
                </div>
                <div class="summary-card">
                    <h3>Total Value</h3>
                    <div class="number" id="totalValue">₱0</div>
                    <div class="subtitle">Inventory Worth</div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label for="category">Category</label>
                    <select id="category">
                        <option value="">Select Category</option>
                        <option value="Metal Scraps">🔩 Metal Scraps</option>
                        <option value="Electronics">📱 Electronics</option>
                        <option value="Appliances">🏠 Appliances</option>
                        <option value="Paper/Cardboard">📄 Paper/Cardboard</option>
                        <option value="Plastic Items">🍼 Plastic Items</option>
                        <option value="Glass Items">🍾 Glass Items</option>
                        <option value="Furniture">🪑 Furniture</option>
                        <option value="Car Parts">🚗 Car Parts</option>
                        <option value="Tools">🔧 Tools</option>
                        <option value="Cables/Wires">⚡ Cables/Wires</option>
                        <option value="Batteries">🔋 Batteries</option>
                        <option value="Other Items">📦 Other Items</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="itemName">Item Name</label>
                    <input type="text" id="itemName" placeholder="Enter item name">
                </div>
                
                <div class="control-group">
                    <label for="quantity">Quantity</label>
                    <input type="number" id="quantity" placeholder="0" min="0">
                </div>
                
                <div class="control-group">
                    <label for="unit">Unit</label>
                    <select id="unit">
                        <option value="pcs">pieces</option>
                        <option value="kg">kilograms</option>
                        <option value="tons">tons</option>
                        <option value="bags">bags</option>
                        <option value="boxes">boxes</option>
                        <option value="bundles">bundles</option>
                        <option value="sets">sets</option>
                        <option value="meters">meters</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="buyPrice">Buy Price (₱)</label>
                    <input type="number" id="buyPrice" placeholder="0.00" min="0" step="0.01">
                </div>
                
                <div class="control-group">
                    <label for="sellPrice">Sell Price (₱)</label>
                    <input type="number" id="sellPrice" placeholder="0.00" min="0" step="0.01">
                </div>
                
                <div class="control-group">
                    <label for="minStock">Min Stock</label>
                    <input type="number" id="minStock" placeholder="0" min="0">
                </div>
                
                <div class="control-group">
                    <label for="description">Description</label>
                    <textarea id="description" placeholder="Item description" rows="2"></textarea>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="addItem()">Add Item</button>
                </div>
            </div>
            
            <div class="controls">
                <button onclick="exportData()" class="btn-warning">Export Data</button>
                <button onclick="document.getElementById('importFile').click()" class="btn-info">Import Data</button>
                <input type="file" id="importFile" class="file-input" accept=".json" onchange="importData(event)">
                <button onclick="clearAllData()" class="btn-danger">Clear All Data</button>
            </div>
            
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Item Name</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Buy Price</th>
                            <th>Sell Price</th>
                            <th>Total Value</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="inventoryBody">
                        <tr class="empty-state">
                            <td colspan="9">
                                <h3>No items in inventory</h3>
                                <p>Add your first item using the form above</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div id="sales" class="tab-content">
            <div class="summary">
                <div class="summary-card">
                    <h3>Today's Sales</h3>
                    <div class="number" id="todaySalesCard">₱0.00</div>
                    <div class="subtitle">Total Revenue</div>
                </div>
                <div class="summary-card">
                    <h3>Items Sold</h3>
                    <div class="number" id="itemsSoldToday">0</div>
                    <div class="subtitle">Today</div>
                </div>
                <div class="summary-card">
                    <h3>Profit</h3>
                    <div class="number" id="todaysProfit">₱0.00</div>
                    <div class="subtitle">Today's Margin</div>
                </div>
                <div class="summary-card">
                    <h3>Total Sales</h3>
                    <div class="number" id="totalSalesEver">₱0.00</div>
                    <div class="subtitle">All Time</div>
                </div>
            </div>
            
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Item</th>
                            <th>Category</th>
                            <th>Qty Sold</th>
                            <th>Sell Price</th>
                            <th>Total</th>
                            <th>Profit</th>
                            <th>Customer</th>
                        </tr>
                    </thead>
                    <tbody id="salesBody">
                        <tr class="empty-state">
                            <td colspan="8">
                                <h3>No sales recorded</h3>
                                <p>Start selling items from your inventory</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div id="reports" class="tab-content">
            <div class="summary">
                <div class="summary-card">
                    <h3>This Week</h3>
                    <div class="number" id="weekSales">₱0.00</div>
                    <div class="subtitle">Sales Revenue</div>
                </div>
                <div class="summary-card">
                    <h3>This Month</h3>
                    <div class="number" id="monthSales">₱0.00</div>
                    <div class="subtitle">Sales Revenue</div>
                </div>
                <div class="summary-card">
                    <h3>Best Category</h3>
                    <div class="number" id="bestCategory">-</div>
                    <div class="subtitle">Top Seller</div>
                </div>
                <div class="summary-card">
                    <h3>Avg Sale</h3>
                    <div class="number" id="avgSale">₱0.00</div>
                    <div class="subtitle">Per Transaction</div>
                </div>
            </div>
            
            <div class="controls">
                <button onclick="generateDailyReport()" class="btn-info">Daily Report</button>
                <button onclick="generateWeeklyReport()" class="btn-info">Weekly Report</button>
                <button onclick="generateMonthlyReport()" class="btn-info">Monthly Report</button>
                <button onclick="exportSalesData()" class="btn-warning">Export Sales</button>
            </div>
            
            <div id="reportContent">
                <div class="empty-state">
                    <h3>Generate Reports</h3>
                    <p>Click on the buttons above to generate sales reports</p>
                </div>
            </div>
        </div>
        
        <div id="settings" class="tab-content">
            <div class="summary">
                <div class="summary-card">
                    <h3>Shop Name</h3>
                    <div class="number">RENZ</div>
                    <div class="subtitle">Junkshop</div>
                </div>
                <div class="summary-card">
                    <h3>System Version</h3>
                    <div class="number">1.0</div>
                    <div class="subtitle">Latest</div>
                </div>
                <div class="summary-card">
                    <h3>Data Storage</h3>
                    <div class="number">Local</div>
                    <div class="subtitle">Browser Storage</div>
                </div>
                <div class="summary-card">
                    <h3>Auto-Save</h3>
                    <div class="number">ON</div>
                    <div class="subtitle">Every 30s</div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label for="shopName">Shop Name</label>
                    <input type="text" id="shopName" value="RENZ JUNKSHOP" placeholder="Enter shop name">
                </div>
                
                <div class="control-group">
                    <label for="shopAddress">Shop Address</label>
                    <textarea id="shopAddress" placeholder="Enter shop address" rows="2"></textarea>
                </div>
                
                <div class="control-group">
                    <label for="shopPhone">Phone Number</label>
                    <input type="text" id="shopPhone" placeholder="Enter phone number">
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="saveSettings()">Save Settings</button>
                </div>
            </div>
            
            <div class="controls">
                <button onclick="backupAllData()" class="btn-warning">Backup All Data</button>
                <button onclick="document.getElementById('restoreFile').click()" class="btn-info">Restore Data</button>
                <input type="file" id="restoreFile" class="file-input" accept=".json" onchange="restoreData(event)">
                <button onclick="resetSystem()" class="btn-danger">Reset System</button>
            </div>
        </div>
    </div>
    
    <div id="sellModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSellModal()">&times;</span>
            <h2>🛒 Sell Item</h2>
            <div class="control-group">
                <label for="sellItemName">Item</label>
                <input type="text" id="sellItemName" readonly>
            </div>
            <div class="control-group">
                <label for="sellQuantity">Quantity to Sell</label>
                <input type="number" id="sellQuantity" min="1" placeholder="1">
            </div>
            <div class="control-group">
                <label for="sellPriceModal">Sell Price per Unit</label>
                <input type="number" id="sellPriceModal" step="0.01" placeholder="0.00">
            </div>
            <div class="control-group">
                <label for="customerName">Customer Name (Optional)</label>
                <input type="text" id="customerName" placeholder="Enter customer name">
            </div>
            <div class="control-group">
                <label>&nbsp;</label>
                <button onclick="processSale()">Complete Sale</button>
                <button onclick="closeSellModal()" class="btn-danger">Cancel</button>
            </div>
        </div>
    </div>
    
    <div id="receiptModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeReceiptModal()">&times;</span>
            <div class="receipt" id="receiptContent">
                </div>
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="printReceipt()" class="btn-info">Print Receipt</button>
                <button onclick="closeReceiptModal()" class="btn-danger">Close</button>
            </div>
        </div>
    </div>

    <script>
        let inventory = [];
        let sales = [];
        let settings = {
            shopName: "RENZ JUNKSHOP",
            shopAddress: "",
            shopPhone: ""
        };
        let currentSellItem = null;
        
        // Common junkshop items by category
        const commonItems = {
            "Metal Scraps": ["Aluminum Cans", "Copper Wire", "Steel Sheets", "Iron Scraps", "Brass Items"],
            "Electronics": ["Old Phones", "Computer Parts", "TV Components", "Radio Parts", "Circuit Boards"],
            "Appliances": ["Electric Fans", "Rice Cookers", "Washing Machine Parts", "Refrigerator Parts", "Microwave Parts"],
            "Paper/Cardboard": ["Newspapers", "Magazines", "Cardboard Boxes", "Office Papers", "Books"],
            "Plastic Items": ["Plastic Bottles", "Containers", "Toys", "Chairs", "Buckets"],
            "Glass Items": ["Bottles", "Jars", "Windows", "Mirrors", "Glassware"],
            "Furniture": ["Chairs", "Tables", "Cabinets", "Beds", "Sofas"],
            "Car Parts": ["Tires", "Batteries", "Engines", "Radiators", "Bumpers"],
            "Tools": ["Hammers", "Screwdrivers", "Wrenches", "Pliers", "Saws"],
            "Cables/Wires": ["Extension Cords", "Speaker Wires", "Network Cables", "Power Cables", "Coaxial Cables"],
            "Batteries": ["Car Batteries", "Phone Batteries", "AA Batteries", "Lead Acid", "Lithium Batteries"],
            "Other Items": ["Clothing", "Books", "Kitchenware", "Decorations", "Sports Equipment"]
        };
        
        // Initialize system
        window.onload = function() {
            loadAllData();
            updateAllDisplays();
            updateLastUpdated();
            
            // Add category change listener
            document.getElementById('category').addEventListener('change', function() {
                updateItemSuggestions();
            });
        };
        
        function updateItemSuggestions() {
            const category = document.getElementById('category').value;
            const itemNameInput = document.getElementById('itemName');
            
            if (category && commonItems[category]) {
                itemNameInput.placeholder = `e.g., ${commonItems[category][0]}`;
            } else {
                itemNameInput.placeholder = "Enter item name";
            }
        }
        
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Update displays when switching tabs
            if (tabName === 'sales') {
                renderSales();
                updateSalesDisplays();
            } else if (tabName === 'reports') {
                updateReportsDisplays();
            }
        }
        
        function addItem() {
            const category = document.getElementById('category').value;
            const itemName = document.getElementById('itemName').value.trim();
            const quantity = parseInt(document.getElementById('quantity').value) || 0;
            const unit = document.getElementById('unit').value;
            const buyPrice = parseFloat(document.getElementById('buyPrice').value) || 0;
            const sellPrice = parseFloat(document.getElementById('sellPrice').value) || 0;
            const minStock = parseInt(document.getElementById('minStock').value) || 0;
            const description = document.getElementById('description').value.trim();
            
            if (!category || !itemName) {
                alert('Please fill in category and item name!');
                return;
            }
            
            const item = {
                id: Date.now(),
                category,
                itemName,
                quantity,
                unit,
                buyPrice,
                sellPrice,
                minStock,
                description,
                dateAdded: new Date().toISOString()
            };
            
            inventory.push(item);
            saveAllData();
            renderInventory();
            updateAllDisplays();
            updateLastUpdated();
            clearForm();
            
            alert('Item added successfully!');
        }
        
        function clearForm() {
            document.getElementById('category').value = '';
            document.getElementById('itemName').value = '';
            document.getElementById('quantity').value = '';
            document.getElementById('buyPrice').value = '';
            document.getElementById('sellPrice').value = '';
            document.getElementById('minStock').value = '';
            document.getElementById('description').value = '';
            document.getElementById('itemName').placeholder = "Enter item name";
        }
        
        function renderInventory() {
            const tbody = document.getElementById('inventoryBody');
            
            if (inventory.length === 0) {
                tbody.innerHTML = `
                    <tr class="empty-state">
                        <td colspan="9">
                            <h3>No items in inventory</h3>
                            <p>Add your first item using the form above</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = inventory.map(item => {
                const totalValue = (item.quantity * item.sellPrice).toFixed(2);
                const isLowStock = item.quantity <= item.minStock;
                const statusClass = isLowStock ? 'status-low' : 'status-normal';
                const statusText = isLowStock ? 'Low Stock' : 'In Stock';
                
                return `
                    <tr>
                        <td>${item.category}</td>
                        <td><strong>${item.itemName}</strong><br><small>${item.description}</small></td>
                        <td>${item.quantity}</td>
                        <td>${item.unit}</td>
                        <td>₱${item.buyPrice.toFixed(2)}</td>
                        <td>₱${item.sellPrice.toFixed(2)}</td>
                        <td>₱${totalValue}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="action-btn btn-sell" onclick="openSellModal(${item.id})">Sell</button>
                            <button class="action-btn btn-edit" onclick="editItem(${item.id})">Edit</button>
                            <button class="action-btn btn-delete" onclick="deleteItem(${item.id})">Delete</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function openSellModal(itemId) {
            const item = inventory.find(i => i.id === itemId);
            if (!item) return;
            
            if (item.quantity <= 0) {
                alert('Item is out of stock!');
                return;
            }
            
            currentSellItem = item;
            document.getElementById('sellItemName').value = item.itemName;
            document.getElementById('sellQuantity').value = 1;
            document.getElementById('sellQuantity').max = item.quantity;
            document.getElementById('sellPriceModal').value = item.sellPrice;
            document.getElementById('customerName').value = '';
            
            document.getElementById('sellModal').style.display = 'block';
        }
        
        function closeSellModal() {
            document.getElementById('sellModal').style.display = 'none';
            currentSellItem = null;
        }
        
        function processSale() {
            if (!currentSellItem) return;
            
            const quantityToSell = parseInt(document.getElementById('sellQuantity').value);
            const sellPrice = parseFloat(document.getElementById('sellPriceModal').value);
            const customerName = document.getElementById('customerName').value.trim() || 'Walk-in Customer';
            
            if (quantityToSell <= 0 || quantityToSell > currentSellItem.quantity) {
                alert('Invalid quantity!');
                return;
            }
            
            if (sellPrice <= 0) {
                alert('Invalid sell price!');
                return;
            }
            
            // Create sale record
            const sale = {
                id: Date.now(),
                itemId: currentSellItem.id,
                itemName: currentSellItem.itemName,
                category: currentSellItem.category,
                quantitySold: quantityToSell,
                sellPrice: sellPrice,
                buyPrice: currentSellItem.buyPrice,
                totalAmount: quantityToSell * sellPrice,
                profit: (sellPrice - currentSellItem.buyPrice) * quantityToSell,
                customerName: customerName,
                date: new Date().toISOString(),
                dateString: new Date().toLocaleDateString()
            };
            
            // Update inventory
            currentSellItem.quantity -= quantityToSell;
            
            // Add to sales
            sales.push(sale);
            
            // Save and update displays
            saveAllData();
            renderInventory();
            updateAllDisplays();
            updateLastUpdated();
            
            // Show receipt
            showReceipt(sale);
            
            closeSellModal();
        }
        
        function showReceipt(sale) {
            const receiptContent = document.getElementById('receiptContent');
            const now = new Date();
            
            receiptContent.innerHTML = `
                <div class="receipt-header">
                    <h2>${settings.shopName}</h2>
                    <p>${settings.shopAddress}</p>
                    <p>${settings.shopPhone}</p>
                    <p>Date: ${now.toLocaleDateString()}</p>
                    <p>Time: ${now.toLocaleTimeString()}</p>
                </div>
                
                <div style="margin: 15px 0;">
                    <p><strong>Customer:</strong> ${sale.customerName}</p>
                    <p><strong>Item:</strong> ${sale.itemName}</p>
                    <p><strong>Category:</strong> ${sale.category}</p>
                    <p><strong>Quantity:</strong> ${sale.quantitySold}</p>
                    <p><strong>Price per unit:</strong> ₱${sale.sellPrice.toFixed(2)}</p>
                    <hr style="border: 1px dashed #ccc; margin: 10px 0;">
                    <p><strong>TOTAL: ₱${sale.totalAmount.toFixed(2)}</strong></p>
                </div>
                
                <div class="receipt-footer">
                    <p>Thank you for your business!</p>
                    <p>Visit us again!</p>
                </div>
            `;
            
            document.getElementById('receiptModal').style.display = 'block';
        }
        
        function closeReceiptModal() {
            document.getElementById('receiptModal').style.display = 'none';
        }
        
        function printReceipt() {
            const receiptContent = document.getElementById('receiptContent').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Receipt</title>
                    <style>
                        body { font-family: 'Courier New', monospace; margin: 20px; }
                        .receipt-header, .receipt-footer { text-align: center; }
                        hr { border: 1px dashed #000; }
                    </style>
                </head>
                <body>${receiptContent}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        function editItem(itemId) {
            const item = inventory.find(i => i.id === itemId);
            if (!item) return;
            
            // Fill form with item data
            document.getElementById('category').value = item.category;
            document.getElementById('itemName').value = item.itemName;
            document.getElementById('quantity').value = item.quantity;
            document.getElementById('unit').value = item.unit;
            document.getElementById('buyPrice').value = item.buyPrice;
            document.getElementById('sellPrice').value = item.sellPrice;
            document.getElementById('minStock').value = item.minStock;
            document.getElementById('description').value = item.description;
            
            // Remove item from inventory
            inventory = inventory.filter(i => i.id !== itemId);
            
            saveAllData();
            renderInventory();
            updateAllDisplays();
            
            alert('Item loaded for editing. Make changes and click "Add Item".');
        }
        
        function deleteItem(itemId) {
            if (confirm('Are you sure you want to delete this item?')) {
                inventory = inventory.filter(i => i.id !== itemId);
                saveAllData();
                renderInventory();
                updateAllDisplays();
                updateLastUpdated();
            }
        }
        
        function renderSales() {
            const tbody = document.getElementById('salesBody');
            
            if (sales.length === 0) {
                tbody.innerHTML = `
                    <tr class="empty-state">
                        <td colspan="8">
                            <h3>No sales recorded</h3>
                            <p>Start selling items from your inventory</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Sort sales by date (newest first)
            const sortedSales = [...sales].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            tbody.innerHTML = sortedSales.map(sale => `
                <tr>
                    <td>${sale.dateString}</td>
                    <td>${sale.itemName}</td>
                    <td>${sale.category}</td>
                    <td>${sale.quantitySold}</td>
                    <td>₱${sale.sellPrice.toFixed(2)}</td>
                    <td>₱${sale.totalAmount.toFixed(2)}</td>
                    <td>₱${sale.profit.toFixed(2)}</td>
                    <td>${sale.customerName}</td>
                </tr>
            `).join('');
        }
        
        function updateAllDisplays() {
            updateInventoryDisplays();
            updateSalesDisplays();
            updateReportsDisplays();
        }
        
        function updateInventoryDisplays() {
            const totalItems = inventory.length;
            const categories = [...new Set(inventory.map(item => item.category))].length;
            const lowStockItems = inventory.filter(item => item.quantity <= item.minStock).length;
            const totalValue = inventory.reduce((sum, item) => sum + (item.quantity * item.sellPrice), 0);
            
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('totalCategories').textContent = categories;
            document.getElementById('lowStockItems').textContent = lowStockItems;
            document.getElementById('totalValue').textContent = `₱${totalValue.toFixed(2)}`;
        }
        
        function updateSalesDisplays() {
            const today = new Date().toLocaleDateString();
            const todaySales = sales.filter(sale => sale.dateString === today);
            
            const todaysRevenue = todaySales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            const todaysProfit = todaySales.reduce((sum, sale) => sum + sale.profit, 0);
            const totalRevenue = sales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            
            document.getElementById('todaySales').textContent = todaysRevenue.toFixed(2);
            document.getElementById('todaySalesCard').textContent = `₱${todaysRevenue.toFixed(2)}`;
            document.getElementById('itemsSoldToday').textContent = todaySales.length;
            document.getElementById('todaysProfit').textContent = `₱${todaysProfit.toFixed(2)}`;
            document.getElementById('totalSalesEver').textContent = `₱${totalRevenue.toFixed(2)}`;
        }
        
        function updateReportsDisplays() {
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            const weekSales = sales.filter(sale => new Date(sale.date) >= weekAgo);
            const monthSales = sales.filter(sale => new Date(sale.date) >= monthAgo);
            
            const weekRevenue = weekSales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            const monthRevenue = monthSales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            
            // Best category
            const categoryStats = {};
            sales.forEach(sale => {
                categoryStats[sale.category] = (categoryStats[sale.category] || 0) + sale.totalAmount;
            });
            
            const bestCategory = Object.keys(categoryStats).reduce((a, b) => 
                categoryStats[a] > categoryStats[b] ? a : b, '-');
            
            const avgSale = sales.length > 0 ? sales.reduce((sum, sale) => sum + sale.totalAmount, 0) / sales.length : 0;
            
            document.getElementById('weekSales').textContent = `₱${weekRevenue.toFixed(2)}`;
            document.getElementById('monthSales').textContent = `₱${monthRevenue.toFixed(2)}`;
            document.getElementById('bestCategory').textContent = bestCategory;
            document.getElementById('avgSale').textContent = `₱${avgSale.toFixed(2)}`;
        }
        
        function updateLastUpdated() {
            const now = new Date();
            document.getElementById('lastUpdated').textContent = now.toLocaleString();
        }
        
        function saveAllData() {
            const data = {
                inventory: inventory,
                sales: sales,
                settings: settings,
                lastSaved: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('renzJunkshopData', JSON.stringify(data));
            } catch(e) {
                console.log('Could not save data:', e);
            }
        }
        
        function loadAllData() {
            try {
                const saved = localStorage.getItem('renzJunkshopData');
                if (saved) {
                    const data = JSON.parse(saved);
                    inventory = data.inventory || [];
                    sales = data.sales || [];
                    settings = data.settings || settings;
                    
                    // Load settings into form
                    document.getElementById('shopName').value = settings.shopName;
                    document.getElementById('shopAddress').value = settings.shopAddress;
                    document.getElementById('shopPhone').value = settings.shopPhone;
                    
                    renderInventory();
                    renderSales();
                }
            } catch(e) {
                console.log('Could not load saved data:', e);
            }
        }
        
        function saveSettings() {
            settings.shopName = document.getElementById('shopName').value;
            settings.shopAddress = document.getElementById('shopAddress').value;
            settings.shopPhone = document.getElementById('shopPhone').value;
            
            saveAllData();
            updateLastUpdated();
            alert('Settings saved successfully!');
        }
        
        function exportData() {
            const data = {
                inventory: inventory,
                sales: sales,
                settings: settings,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `renz-junkshop-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.inventory && Array.isArray(data.inventory)) {
                        inventory = data.inventory;
                        if (data.sales && Array.isArray(data.sales)) {
                            sales = data.sales;
                        }
                        if (data.settings) {
                            settings = data.settings;
                        }
                        
                        saveAllData();
                        renderInventory();
                        renderSales();
                        updateAllDisplays();
                        updateLastUpdated();
                        alert('Data imported successfully!');
                    } else {
                        alert('Invalid file format!');
                    }
                } catch(error) {
                    alert('Error reading file: ' + error.message);
                }
            };
            reader.readAsText(file);
        }
        
        function backupAllData() {
            exportData();
            alert('Data backup downloaded successfully!');
        }
        
        function restoreData(event) {
            if (confirm('This will replace all current data. Are you sure?')) {
                importData(event);
            }
        }
        
        function clearAllData() {
            if (confirm('Are you sure you want to clear all inventory data? This cannot be undone!')) {
                inventory = [];
                saveAllData();
                renderInventory();
                updateAllDisplays();
                updateLastUpdated();
            }
        }
        
        function resetSystem() {
            if (confirm('This will reset the entire system including inventory, sales, and settings. Are you sure?')) {
                if (confirm('This action cannot be undone. Continue?')) {
                    localStorage.removeItem('renzJunkshopData');
                    location.reload();
                }
            }
        }
        
        function generateDailyReport() {
            const today = new Date().toLocaleDateString();
            const todaySales = sales.filter(sale => sale.dateString === today);
            
            let reportHTML = `
                <div class="data-table">
                    <h3>Daily Sales Report - ${today}</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Item</th>
                                <th>Quantity</th>
                                <th>Amount</th>
                                <th>Profit</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            if (todaySales.length === 0) {
                reportHTML += `
                    <tr><td colspan="5" style="text-align: center;">No sales today</td></tr>
                `;
            } else {
                todaySales.forEach(sale => {
                    const time = new Date(sale.date).toLocaleTimeString();
                    reportHTML += `
                        <tr>
                            <td>${time}</td>
                            <td>${sale.itemName}</td>
                            <td>${sale.quantitySold}</td>
                            <td>₱${sale.totalAmount.toFixed(2)}</td>
                            <td>₱${sale.profit.toFixed(2)}</td>
                        </tr>
                    `;
                });
                
                const totalRevenue = todaySales.reduce((sum, sale) => sum + sale.totalAmount, 0);
                const totalProfit = todaySales.reduce((sum, sale) => sum + sale.profit, 0);
                
                reportHTML += `
                    <tr style="background: #f8f9fa; font-weight: bold;">
                        <td colspan="3">TOTALS</td>
                        <td>₱${totalRevenue.toFixed(2)}</td>
                        <td>₱${totalProfit.toFixed(2)}</td>
                    </tr>
                `;
            }
            
            reportHTML += '</tbody></table></div>';
            document.getElementById('reportContent').innerHTML = reportHTML;
        }
        
        function generateWeeklyReport() {
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const weekSales = sales.filter(sale => new Date(sale.date) >= weekAgo);
            
            // Group by date
            const dailyStats = {};
            weekSales.forEach(sale => {
                const date = sale.dateString;
                if (!dailyStats[date]) {
                    dailyStats[date] = { revenue: 0, profit: 0, items: 0 };
                }
                dailyStats[date].revenue += sale.totalAmount;
                dailyStats[date].profit += sale.profit;
                dailyStats[date].items += sale.quantitySold;
            });
            
            let reportHTML = `
                <div class="data-table">
                    <h3>Weekly Sales Report (Last 7 Days)</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Items Sold</th>
                                <th>Revenue</th>
                                <th>Profit</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            if (Object.keys(dailyStats).length === 0) {
                reportHTML += `<tr><td colspan="4" style="text-align: center;">No sales this week</td></tr>`;
            } else {
                let totalRevenue = 0, totalProfit = 0, totalItems = 0;
                
                Object.keys(dailyStats).sort().forEach(date => {
                    const stats = dailyStats[date];
                    totalRevenue += stats.revenue;
                    totalProfit += stats.profit;
                    totalItems += stats.items;
                    
                    reportHTML += `
                        <tr>
                            <td>${date}</td>
                            <td>${stats.items}</td>
                            <td>₱${stats.revenue.toFixed(2)}</td>
                            <td>₱${stats.profit.toFixed(2)}</td>
                        </tr>
                    `;
                });
                
                reportHTML += `
                    <tr style="background: #f8f9fa; font-weight: bold;">
                        <td>TOTALS</td>
                        <td>${totalItems}</td>
                        <td>₱${totalRevenue.toFixed(2)}</td>
                        <td>₱${totalProfit.toFixed(2)}</td>
                    </tr>
                `;
            }
            
            reportHTML += '</tbody></table></div>';
            document.getElementById('reportContent').innerHTML = reportHTML;
        }
        
        function generateMonthlyReport() {
            const now = new Date();
            const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            const monthSales = sales.filter(sale => new Date(sale.date) >= monthAgo);
            
            // Group by category
            const categoryStats = {};
            monthSales.forEach(sale => {
                if (!categoryStats[sale.category]) {
                    categoryStats[sale.category] = { revenue: 0, profit: 0, items: 0 };
                }
                categoryStats[sale.category].revenue += sale.totalAmount;
                categoryStats[sale.category].profit += sale.profit;
                categoryStats[sale.category].items += sale.quantitySold;
            });
            
            let reportHTML = `
                <div class="data-table">
                    <h3>Monthly Sales Report by Category (Last 30 Days)</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Items Sold</th>
                                <th>Revenue</th>
                                <th>Profit</th>
                                <th>Avg per Item</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            if (Object.keys(categoryStats).length === 0) {
                reportHTML += `<tr><td colspan="5" style="text-align: center;">No sales this month</td></tr>`;
            } else {
                let totalRevenue = 0, totalProfit = 0, totalItems = 0;
                
                // Sort by revenue
                const sortedCategories = Object.keys(categoryStats).sort((a, b) => categoryStats[b].revenue - categoryStats[a].revenue);
                
                sortedCategories.forEach(category => {
                    const stats = categoryStats[category];
                    totalRevenue += stats.revenue;
                    totalProfit += stats.profit;
                    totalItems += stats.items;
                    const avgPerItem = stats.items > 0 ? (stats.revenue / stats.items) : 0;
                    
                    reportHTML += `
                        <tr>
                            <td>${category}</td>
                            <td>${stats.items}</td>
                            <td>₱${stats.revenue.toFixed(2)}</td>
                            <td>₱${stats.profit.toFixed(2)}</td>
                            <td>₱${avgPerItem.toFixed(2)}</td>
                        </tr>
                    `;
                });
                
                reportHTML += `
                    <tr style="background: #f8f9fa; font-weight: bold;">
                        <td>TOTALS</td>
                        <td>${totalItems}</td>
                        <td>₱${totalRevenue.toFixed(2)}</td>
                        <td>₱${totalProfit.toFixed(2)}</td>
                        <td></td>
                    </tr>
                `;
            }
            
            reportHTML += '</tbody></table></div>';
            document.getElementById('reportContent').innerHTML = reportHTML;
        }
        
        function exportSalesData() {
            const data = {
                sales: sales,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `renz-junkshop-sales-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('Sales data exported successfully!');
        }

        // Auto-save functionality
        setInterval(saveAllData, 30000); // Save every 30 seconds

    </script>
</body>
</html>
